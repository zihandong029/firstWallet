<!DOCTYPE html>
<html>
<head>
    <title>æµ‹è¯•å¯†ç åŠ å¯†åŠ©è®°è¯</title>
    <style>
        body {
            font-family: monospace;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #00ff00;
        }
        .section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #00ff00;
        }
        .step {
            margin: 10px 0;
            padding: 10px;
            background: #333;
            border-radius: 5px;
        }
        .data {
            word-break: break-all;
            background: #000;
            padding: 10px;
            margin: 5px 0;
            border-radius: 3px;
            color: #ffff00;
        }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .highlight {
            color: #ff6600;
            font-weight: bold;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
    <h1>ğŸ” å¯†ç åŠ å¯†åŠ©è®°è¯è¯¦è§£</h1>
    
    <div class="section">
        <h3>ğŸ¯ æµ‹è¯•å‚æ•°</h3>
        <div class="step">
            <strong>ç”¨æˆ·å¯†ç :</strong> <span class="highlight">mypassword123</span>
        </div>
        <div class="step">
            <strong>ç¤ºä¾‹åŠ©è®°è¯:</strong> <span class="highlight">abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about</span>
        </div>
    </div>

    <button onclick="demonstrateEncryption()">ğŸš€ å¼€å§‹æ¼”ç¤ºåŠ å¯†è¿‡ç¨‹</button>

    <div id="results"></div>

    <script>
        function demonstrateEncryption() {
            const results = document.getElementById('results');
            results.innerHTML = '';

            // æ¨¡æ‹Ÿé’±åŒ…çŠ¶æ€
            const walletState = {
                isLocked: false,
                accounts: [{
                    address: "0x742d35Cc6065C0532C30c0C93c0f1C6F47c5c4F3",
                    privateKey: "0x4c0883a69102937d6231471b5dbb6204fe5129617082792ae468d01a3f362318",
                    publicKey: "",
                    index: 0
                }],
                currentAccount: 0,
                mnemonic: "abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about",
                networks: [
                    {
                        name: "Ethereum Mainnet",
                        rpcUrls: ["https://mainnet.infura.io/v3/YOUR-PROJECT-ID"],
                        chainId: 1,
                        symbol: "ETH"
                    }
                ],
                currentNetwork: 0
            };

            const password = "mypassword123";

            console.log('ğŸ”„ å¼€å§‹åŠ å¯†æ¼”ç¤º...');

            // ç¬¬1æ­¥ï¼šJSONåºåˆ—åŒ–
            addSection('ç¬¬1æ­¥ï¼šå°†é’±åŒ…çŠ¶æ€è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²', 
                'å°†åŒ…å«åŠ©è®°è¯çš„é’±åŒ…çŠ¶æ€å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²');
            
            const jsonString = JSON.stringify(walletState, null, 2);
            console.log('ğŸ“„ JSONå­—ç¬¦ä¸²:', jsonString);
            
            addStep('åŸå§‹JSONæ•°æ® (åŒ…å«åŠ©è®°è¯):', jsonString);

            // ç¬¬2æ­¥ï¼šåŠ å¯†
            addSection('ç¬¬2æ­¥ï¼šä½¿ç”¨AESç®—æ³•åŠ å¯†', 
                'ä½¿ç”¨ç”¨æˆ·å¯†ç ä½œä¸ºå¯†é’¥ï¼ŒAES-256-CBCæ¨¡å¼åŠ å¯†');

            const encrypted = CryptoJS.AES.encrypt(jsonString, password).toString();
            console.log('ğŸ” åŠ å¯†ç»“æœ:', encrypted);
            
            addStep('å¯†ç :', password);
            addStep('åŠ å¯†åçš„æ•°æ®:', encrypted);

            // ç¬¬3æ­¥ï¼šè§£æåŠ å¯†ç»“æœ
            addSection('ç¬¬3æ­¥ï¼šè§£æåŠ å¯†ç»“æœç»“æ„', 
                'CryptoJS ç”Ÿæˆçš„åŠ å¯†å­—ç¬¦ä¸²åŒ…å«å¤šä¸ªéƒ¨åˆ†');

            // è§£æ CryptoJS æ ¼å¼
            const encryptedObj = CryptoJS.enc.Base64.parse(encrypted);
            addStep('åŠ å¯†æ•°æ®é•¿åº¦:', encrypted.length + ' å­—ç¬¦');
            addStep('ç¼–ç æ ¼å¼:', 'Base64');
            addStep('åŒ…å«å†…å®¹:', 'IV (åˆå§‹åŒ–å‘é‡) + åŠ å¯†çš„æ•°æ®');

            // ç¬¬4æ­¥ï¼šè§£å¯†éªŒè¯
            addSection('ç¬¬4æ­¥ï¼šè§£å¯†éªŒè¯', 
                'ä½¿ç”¨ç›¸åŒå¯†ç è§£å¯†ï¼ŒéªŒè¯åŠ å¯†çš„æ­£ç¡®æ€§');

            try {
                const decrypted = CryptoJS.AES.decrypt(encrypted, password).toString(CryptoJS.enc.Utf8);
                const decryptedObj = JSON.parse(decrypted);
                
                console.log('âœ… è§£å¯†æˆåŠŸ:', decryptedObj);
                
                addStep('è§£å¯†ç»“æœ:', 'âœ… æˆåŠŸ');
                addStep('æ¢å¤çš„åŠ©è®°è¯:', decryptedObj.mnemonic);
                addStep('æ¢å¤çš„åœ°å€:', decryptedObj.accounts[0].address);
                
            } catch (error) {
                addStep('è§£å¯†ç»“æœ:', 'âŒ å¤±è´¥: ' + error.message);
            }

            // ç¬¬5æ­¥ï¼šé”™è¯¯å¯†ç æµ‹è¯•
            addSection('ç¬¬5æ­¥ï¼šé”™è¯¯å¯†ç æµ‹è¯•', 
                'ä½¿ç”¨é”™è¯¯å¯†ç å°è¯•è§£å¯†');

            try {
                const wrongDecrypted = CryptoJS.AES.decrypt(encrypted, "wrongpassword").toString(CryptoJS.enc.Utf8);
                const wrongObj = JSON.parse(wrongDecrypted);
                addStep('é”™è¯¯å¯†ç è§£å¯†:', 'âŒ ä¸åº”è¯¥æˆåŠŸ');
            } catch (error) {
                addStep('é”™è¯¯å¯†ç è§£å¯†:', 'âœ… æ­£ç¡®å¤±è´¥: ' + error.message);
                console.log('âœ… é”™è¯¯å¯†ç æ­£ç¡®åœ°è§£å¯†å¤±è´¥');
            }

            // å®‰å…¨æ€§åˆ†æ
            addSection('ğŸ›¡ï¸ å®‰å…¨æ€§åˆ†æ', 
                'è¿™ç§åŠ å¯†æ–¹å¼çš„å®‰å…¨ç‰¹ç‚¹');
            
            addStep('ç®—æ³•å¼ºåº¦:', 'AES-256 æ˜¯å†›ç”¨çº§åŠ å¯†ç®—æ³•');
            addStep('å¯†é’¥æ¥æº:', 'ç›´æ¥ä½¿ç”¨ç”¨æˆ·å¯†ç  (å¯èƒ½å­˜åœ¨å¼±å¯†ç é£é™©)');
            addStep('å­˜å‚¨ä½ç½®:', 'æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ (chrome.storage.local)');
            addStep('æ”»å‡»å‘é‡:', 'æš´åŠ›ç ´è§£å¯†ç ã€æœ¬åœ°å­˜å‚¨è®¿é—®');
            
            addSection('ğŸ’¡ æ”¹è¿›å»ºè®®', 
                'å¯ä»¥å¢å¼ºå®‰å…¨æ€§çš„æ–¹æ³•');
            
            addStep('å¯†é’¥æ´¾ç”Ÿ:', 'ä½¿ç”¨ PBKDF2 æˆ– scrypt ä»å¯†ç æ´¾ç”Ÿå¯†é’¥');
            addStep('ç›å€¼:', 'æ·»åŠ éšæœºç›å€¼é˜²æ­¢å½©è™¹è¡¨æ”»å‡»');
            addStep('è¿­ä»£æ¬¡æ•°:', 'å¢åŠ è®¡ç®—æˆæœ¬ï¼Œå‡æ…¢æš´åŠ›ç ´è§£');
            addStep('ç¡¬ä»¶å®‰å…¨:', 'è€ƒè™‘é›†æˆç¡¬ä»¶å®‰å…¨æ¨¡å— (HSM)');
        }

        function addSection(title, description) {
            const results = document.getElementById('results');
            const section = document.createElement('div');
            section.className = 'section';
            section.innerHTML = `
                <h3>${title}</h3>
                <p>${description}</p>
            `;
            results.appendChild(section);
        }

        function addStep(label, content) {
            const results = document.getElementById('results');
            const lastSection = results.lastElementChild;
            const step = document.createElement('div');
            step.className = 'step';
            step.innerHTML = `
                <strong>${label}</strong>
                <div class="data">${content}</div>
            `;
            lastSection.appendChild(step);
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºè¯´æ˜
        window.onload = function() {
            console.log('ğŸš€ å¯†ç åŠ å¯†åŠ©è®°è¯æ¼”ç¤ºé¡µé¢å·²åŠ è½½');
            console.log('ğŸ” ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹å®Œæ•´çš„åŠ å¯†è¿‡ç¨‹');
        };
    </script>
</body>
</html>
